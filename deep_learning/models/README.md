# Note model

## I. Brain tumor

### 1. Model sử dụng pretrained inceptionresnetv1 96% acc

Link: [Inceptionresnetv1 96%](../inception_resnet_v2_only_train_test_96.ipynb)

Path to model dict: [https://drive.google.com/file/d/1n1v4N4c_A1M1ljTKSrnU530qr0Hya_FL/view?usp=sharing](https://drive.google.com/file/d/1n1v4N4c_A1M1ljTKSrnU530qr0Hya_FL/view?usp=sharing)

#### Chia data

Chia tập dataset ra làm 2

- Training set: 80% datasets có 202/253 data
- Test set: 20% datasets có 51/253 data

#### Hyperparameters

```Python
num_epochs = 100
batch_size = 16
learning_rate = 1e-3
```

#### Pre-trained model

Sử dụng pre-trained `Inceptionresnetv1`, freeze tất cả layer đầu.

Thay đổi layer cuối như sau:

```Python
model_ft.last_linear = nn.Sequential(
    nn.Dropout(0.1),
    nn.Linear(num_inputs, 1000),
    nn.ReLU(),
    nn.Linear(1000, 512),
    nn.ReLU(),
    nn.Linear(512,448),
    nn.ReLU(),
    nn.Linear(448, 320),
    nn.ReLU(),
    nn.Linear(320, 2)
)
```

Model summary:

```shell
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1         [-1, 32, 149, 149]             864
       BatchNorm2d-2         [-1, 32, 149, 149]              64
              ReLU-3         [-1, 32, 149, 149]               0
       BasicConv2d-4         [-1, 32, 149, 149]               0
            Conv2d-5         [-1, 32, 147, 147]           9,216
       BatchNorm2d-6         [-1, 32, 147, 147]              64
              ReLU-7         [-1, 32, 147, 147]               0
       BasicConv2d-8         [-1, 32, 147, 147]               0
            Conv2d-9         [-1, 64, 147, 147]          18,432
      BatchNorm2d-10         [-1, 64, 147, 147]             128
             ReLU-11         [-1, 64, 147, 147]               0
      BasicConv2d-12         [-1, 64, 147, 147]               0
        MaxPool2d-13           [-1, 64, 73, 73]               0
           Conv2d-14           [-1, 80, 73, 73]           5,120
      BatchNorm2d-15           [-1, 80, 73, 73]             160
             ReLU-16           [-1, 80, 73, 73]               0
      BasicConv2d-17           [-1, 80, 73, 73]               0
           Conv2d-18          [-1, 192, 71, 71]         138,240
      BatchNorm2d-19          [-1, 192, 71, 71]             384
             ReLU-20          [-1, 192, 71, 71]               0
      BasicConv2d-21          [-1, 192, 71, 71]               0
        MaxPool2d-22          [-1, 192, 35, 35]               0
           Conv2d-23           [-1, 96, 35, 35]          18,432
      BatchNorm2d-24           [-1, 96, 35, 35]             192
             ReLU-25           [-1, 96, 35, 35]               0
      BasicConv2d-26           [-1, 96, 35, 35]               0
           Conv2d-27           [-1, 48, 35, 35]           9,216
      BatchNorm2d-28           [-1, 48, 35, 35]              96
             ReLU-29           [-1, 48, 35, 35]               0
      BasicConv2d-30           [-1, 48, 35, 35]               0
           Conv2d-31           [-1, 64, 35, 35]          76,800
      BatchNorm2d-32           [-1, 64, 35, 35]             128
             ReLU-33           [-1, 64, 35, 35]               0
      BasicConv2d-34           [-1, 64, 35, 35]               0
           Conv2d-35           [-1, 64, 35, 35]          12,288
      BatchNorm2d-36           [-1, 64, 35, 35]             128
             ReLU-37           [-1, 64, 35, 35]               0
      BasicConv2d-38           [-1, 64, 35, 35]               0
           Conv2d-39           [-1, 96, 35, 35]          55,296
      BatchNorm2d-40           [-1, 96, 35, 35]             192
             ReLU-41           [-1, 96, 35, 35]               0
      BasicConv2d-42           [-1, 96, 35, 35]               0
           Conv2d-43           [-1, 96, 35, 35]          82,944
      BatchNorm2d-44           [-1, 96, 35, 35]             192
             ReLU-45           [-1, 96, 35, 35]               0
      BasicConv2d-46           [-1, 96, 35, 35]               0
        AvgPool2d-47          [-1, 192, 35, 35]               0
           Conv2d-48           [-1, 64, 35, 35]          12,288
      BatchNorm2d-49           [-1, 64, 35, 35]             128
             ReLU-50           [-1, 64, 35, 35]               0
      BasicConv2d-51           [-1, 64, 35, 35]               0
         Mixed_5b-52          [-1, 320, 35, 35]               0
           Conv2d-53           [-1, 32, 35, 35]          10,240
      BatchNorm2d-54           [-1, 32, 35, 35]              64
             ReLU-55           [-1, 32, 35, 35]               0
      BasicConv2d-56           [-1, 32, 35, 35]               0
           Conv2d-57           [-1, 32, 35, 35]          10,240
      BatchNorm2d-58           [-1, 32, 35, 35]              64
             ReLU-59           [-1, 32, 35, 35]               0
      BasicConv2d-60           [-1, 32, 35, 35]               0
           Conv2d-61           [-1, 32, 35, 35]           9,216
      BatchNorm2d-62           [-1, 32, 35, 35]              64
             ReLU-63           [-1, 32, 35, 35]               0
      BasicConv2d-64           [-1, 32, 35, 35]               0
           Conv2d-65           [-1, 32, 35, 35]          10,240
      BatchNorm2d-66           [-1, 32, 35, 35]              64
             ReLU-67           [-1, 32, 35, 35]               0
      BasicConv2d-68           [-1, 32, 35, 35]               0
           Conv2d-69           [-1, 48, 35, 35]          13,824
      BatchNorm2d-70           [-1, 48, 35, 35]              96
             ReLU-71           [-1, 48, 35, 35]               0
      BasicConv2d-72           [-1, 48, 35, 35]               0
           Conv2d-73           [-1, 64, 35, 35]          27,648
      BatchNorm2d-74           [-1, 64, 35, 35]             128
             ReLU-75           [-1, 64, 35, 35]               0
      BasicConv2d-76           [-1, 64, 35, 35]               0
           Conv2d-77          [-1, 320, 35, 35]          41,280
             ReLU-78          [-1, 320, 35, 35]               0
          Block35-79          [-1, 320, 35, 35]               0
           Conv2d-80           [-1, 32, 35, 35]          10,240
      BatchNorm2d-81           [-1, 32, 35, 35]              64
             ReLU-82           [-1, 32, 35, 35]               0
      BasicConv2d-83           [-1, 32, 35, 35]               0
           Conv2d-84           [-1, 32, 35, 35]          10,240
      BatchNorm2d-85           [-1, 32, 35, 35]              64
             ReLU-86           [-1, 32, 35, 35]               0
      BasicConv2d-87           [-1, 32, 35, 35]               0
           Conv2d-88           [-1, 32, 35, 35]           9,216
      BatchNorm2d-89           [-1, 32, 35, 35]              64
             ReLU-90           [-1, 32, 35, 35]               0
      BasicConv2d-91           [-1, 32, 35, 35]               0
           Conv2d-92           [-1, 32, 35, 35]          10,240
      BatchNorm2d-93           [-1, 32, 35, 35]              64
             ReLU-94           [-1, 32, 35, 35]               0
      BasicConv2d-95           [-1, 32, 35, 35]               0
           Conv2d-96           [-1, 48, 35, 35]          13,824
      BatchNorm2d-97           [-1, 48, 35, 35]              96
             ReLU-98           [-1, 48, 35, 35]               0
      BasicConv2d-99           [-1, 48, 35, 35]               0
          Conv2d-100           [-1, 64, 35, 35]          27,648
     BatchNorm2d-101           [-1, 64, 35, 35]             128
            ReLU-102           [-1, 64, 35, 35]               0
     BasicConv2d-103           [-1, 64, 35, 35]               0
          Conv2d-104          [-1, 320, 35, 35]          41,280
            ReLU-105          [-1, 320, 35, 35]               0
         Block35-106          [-1, 320, 35, 35]               0
          Conv2d-107           [-1, 32, 35, 35]          10,240
     BatchNorm2d-108           [-1, 32, 35, 35]              64
            ReLU-109           [-1, 32, 35, 35]               0
     BasicConv2d-110           [-1, 32, 35, 35]               0
          Conv2d-111           [-1, 32, 35, 35]          10,240
     BatchNorm2d-112           [-1, 32, 35, 35]              64
            ReLU-113           [-1, 32, 35, 35]               0
     BasicConv2d-114           [-1, 32, 35, 35]               0
          Conv2d-115           [-1, 32, 35, 35]           9,216
     BatchNorm2d-116           [-1, 32, 35, 35]              64
            ReLU-117           [-1, 32, 35, 35]               0
     BasicConv2d-118           [-1, 32, 35, 35]               0
          Conv2d-119           [-1, 32, 35, 35]          10,240
     BatchNorm2d-120           [-1, 32, 35, 35]              64
            ReLU-121           [-1, 32, 35, 35]               0
     BasicConv2d-122           [-1, 32, 35, 35]               0
          Conv2d-123           [-1, 48, 35, 35]          13,824
     BatchNorm2d-124           [-1, 48, 35, 35]              96
            ReLU-125           [-1, 48, 35, 35]               0
     BasicConv2d-126           [-1, 48, 35, 35]               0
          Conv2d-127           [-1, 64, 35, 35]          27,648
     BatchNorm2d-128           [-1, 64, 35, 35]             128
            ReLU-129           [-1, 64, 35, 35]               0
     BasicConv2d-130           [-1, 64, 35, 35]               0
          Conv2d-131          [-1, 320, 35, 35]          41,280
            ReLU-132          [-1, 320, 35, 35]               0
         Block35-133          [-1, 320, 35, 35]               0
          Conv2d-134           [-1, 32, 35, 35]          10,240
     BatchNorm2d-135           [-1, 32, 35, 35]              64
            ReLU-136           [-1, 32, 35, 35]               0
     BasicConv2d-137           [-1, 32, 35, 35]               0
          Conv2d-138           [-1, 32, 35, 35]          10,240
     BatchNorm2d-139           [-1, 32, 35, 35]              64
            ReLU-140           [-1, 32, 35, 35]               0
     BasicConv2d-141           [-1, 32, 35, 35]               0
          Conv2d-142           [-1, 32, 35, 35]           9,216
     BatchNorm2d-143           [-1, 32, 35, 35]              64
            ReLU-144           [-1, 32, 35, 35]               0
     BasicConv2d-145           [-1, 32, 35, 35]               0
          Conv2d-146           [-1, 32, 35, 35]          10,240
     BatchNorm2d-147           [-1, 32, 35, 35]              64
            ReLU-148           [-1, 32, 35, 35]               0
     BasicConv2d-149           [-1, 32, 35, 35]               0
          Conv2d-150           [-1, 48, 35, 35]          13,824
     BatchNorm2d-151           [-1, 48, 35, 35]              96
            ReLU-152           [-1, 48, 35, 35]               0
     BasicConv2d-153           [-1, 48, 35, 35]               0
          Conv2d-154           [-1, 64, 35, 35]          27,648
     BatchNorm2d-155           [-1, 64, 35, 35]             128
            ReLU-156           [-1, 64, 35, 35]               0
     BasicConv2d-157           [-1, 64, 35, 35]               0
          Conv2d-158          [-1, 320, 35, 35]          41,280
            ReLU-159          [-1, 320, 35, 35]               0
         Block35-160          [-1, 320, 35, 35]               0
          Conv2d-161           [-1, 32, 35, 35]          10,240
     BatchNorm2d-162           [-1, 32, 35, 35]              64
            ReLU-163           [-1, 32, 35, 35]               0
     BasicConv2d-164           [-1, 32, 35, 35]               0
          Conv2d-165           [-1, 32, 35, 35]          10,240
     BatchNorm2d-166           [-1, 32, 35, 35]              64
            ReLU-167           [-1, 32, 35, 35]               0
     BasicConv2d-168           [-1, 32, 35, 35]               0
          Conv2d-169           [-1, 32, 35, 35]           9,216
     BatchNorm2d-170           [-1, 32, 35, 35]              64
            ReLU-171           [-1, 32, 35, 35]               0
     BasicConv2d-172           [-1, 32, 35, 35]               0
          Conv2d-173           [-1, 32, 35, 35]          10,240
     BatchNorm2d-174           [-1, 32, 35, 35]              64
            ReLU-175           [-1, 32, 35, 35]               0
     BasicConv2d-176           [-1, 32, 35, 35]               0
          Conv2d-177           [-1, 48, 35, 35]          13,824
     BatchNorm2d-178           [-1, 48, 35, 35]              96
            ReLU-179           [-1, 48, 35, 35]               0
     BasicConv2d-180           [-1, 48, 35, 35]               0
          Conv2d-181           [-1, 64, 35, 35]          27,648
     BatchNorm2d-182           [-1, 64, 35, 35]             128
            ReLU-183           [-1, 64, 35, 35]               0
     BasicConv2d-184           [-1, 64, 35, 35]               0
          Conv2d-185          [-1, 320, 35, 35]          41,280
            ReLU-186          [-1, 320, 35, 35]               0
         Block35-187          [-1, 320, 35, 35]               0
          Conv2d-188           [-1, 32, 35, 35]          10,240
     BatchNorm2d-189           [-1, 32, 35, 35]              64
            ReLU-190           [-1, 32, 35, 35]               0
     BasicConv2d-191           [-1, 32, 35, 35]               0
          Conv2d-192           [-1, 32, 35, 35]          10,240
     BatchNorm2d-193           [-1, 32, 35, 35]              64
            ReLU-194           [-1, 32, 35, 35]               0
     BasicConv2d-195           [-1, 32, 35, 35]               0
          Conv2d-196           [-1, 32, 35, 35]           9,216
     BatchNorm2d-197           [-1, 32, 35, 35]              64
            ReLU-198           [-1, 32, 35, 35]               0
     BasicConv2d-199           [-1, 32, 35, 35]               0
          Conv2d-200           [-1, 32, 35, 35]          10,240
     BatchNorm2d-201           [-1, 32, 35, 35]              64
            ReLU-202           [-1, 32, 35, 35]               0
     BasicConv2d-203           [-1, 32, 35, 35]               0
          Conv2d-204           [-1, 48, 35, 35]          13,824
     BatchNorm2d-205           [-1, 48, 35, 35]              96
            ReLU-206           [-1, 48, 35, 35]               0
     BasicConv2d-207           [-1, 48, 35, 35]               0
          Conv2d-208           [-1, 64, 35, 35]          27,648
     BatchNorm2d-209           [-1, 64, 35, 35]             128
            ReLU-210           [-1, 64, 35, 35]               0
     BasicConv2d-211           [-1, 64, 35, 35]               0
          Conv2d-212          [-1, 320, 35, 35]          41,280
            ReLU-213          [-1, 320, 35, 35]               0
         Block35-214          [-1, 320, 35, 35]               0
          Conv2d-215           [-1, 32, 35, 35]          10,240
     BatchNorm2d-216           [-1, 32, 35, 35]              64
            ReLU-217           [-1, 32, 35, 35]               0
     BasicConv2d-218           [-1, 32, 35, 35]               0
          Conv2d-219           [-1, 32, 35, 35]          10,240
     BatchNorm2d-220           [-1, 32, 35, 35]              64
            ReLU-221           [-1, 32, 35, 35]               0
     BasicConv2d-222           [-1, 32, 35, 35]               0
          Conv2d-223           [-1, 32, 35, 35]           9,216
     BatchNorm2d-224           [-1, 32, 35, 35]              64
            ReLU-225           [-1, 32, 35, 35]               0
     BasicConv2d-226           [-1, 32, 35, 35]               0
          Conv2d-227           [-1, 32, 35, 35]          10,240
     BatchNorm2d-228           [-1, 32, 35, 35]              64
            ReLU-229           [-1, 32, 35, 35]               0
     BasicConv2d-230           [-1, 32, 35, 35]               0
          Conv2d-231           [-1, 48, 35, 35]          13,824
     BatchNorm2d-232           [-1, 48, 35, 35]              96
            ReLU-233           [-1, 48, 35, 35]               0
     BasicConv2d-234           [-1, 48, 35, 35]               0
          Conv2d-235           [-1, 64, 35, 35]          27,648
     BatchNorm2d-236           [-1, 64, 35, 35]             128
            ReLU-237           [-1, 64, 35, 35]               0
     BasicConv2d-238           [-1, 64, 35, 35]               0
          Conv2d-239          [-1, 320, 35, 35]          41,280
            ReLU-240          [-1, 320, 35, 35]               0
         Block35-241          [-1, 320, 35, 35]               0
          Conv2d-242           [-1, 32, 35, 35]          10,240
     BatchNorm2d-243           [-1, 32, 35, 35]              64
            ReLU-244           [-1, 32, 35, 35]               0
     BasicConv2d-245           [-1, 32, 35, 35]               0
          Conv2d-246           [-1, 32, 35, 35]          10,240
     BatchNorm2d-247           [-1, 32, 35, 35]              64
            ReLU-248           [-1, 32, 35, 35]               0
     BasicConv2d-249           [-1, 32, 35, 35]               0
          Conv2d-250           [-1, 32, 35, 35]           9,216
     BatchNorm2d-251           [-1, 32, 35, 35]              64
            ReLU-252           [-1, 32, 35, 35]               0
     BasicConv2d-253           [-1, 32, 35, 35]               0
          Conv2d-254           [-1, 32, 35, 35]          10,240
     BatchNorm2d-255           [-1, 32, 35, 35]              64
            ReLU-256           [-1, 32, 35, 35]               0
     BasicConv2d-257           [-1, 32, 35, 35]               0
          Conv2d-258           [-1, 48, 35, 35]          13,824
     BatchNorm2d-259           [-1, 48, 35, 35]              96
            ReLU-260           [-1, 48, 35, 35]               0
     BasicConv2d-261           [-1, 48, 35, 35]               0
          Conv2d-262           [-1, 64, 35, 35]          27,648
     BatchNorm2d-263           [-1, 64, 35, 35]             128
            ReLU-264           [-1, 64, 35, 35]               0
     BasicConv2d-265           [-1, 64, 35, 35]               0
          Conv2d-266          [-1, 320, 35, 35]          41,280
            ReLU-267          [-1, 320, 35, 35]               0
         Block35-268          [-1, 320, 35, 35]               0
          Conv2d-269           [-1, 32, 35, 35]          10,240
     BatchNorm2d-270           [-1, 32, 35, 35]              64
            ReLU-271           [-1, 32, 35, 35]               0
     BasicConv2d-272           [-1, 32, 35, 35]               0
          Conv2d-273           [-1, 32, 35, 35]          10,240
     BatchNorm2d-274           [-1, 32, 35, 35]              64
            ReLU-275           [-1, 32, 35, 35]               0
     BasicConv2d-276           [-1, 32, 35, 35]               0
          Conv2d-277           [-1, 32, 35, 35]           9,216
     BatchNorm2d-278           [-1, 32, 35, 35]              64
            ReLU-279           [-1, 32, 35, 35]               0
     BasicConv2d-280           [-1, 32, 35, 35]               0
          Conv2d-281           [-1, 32, 35, 35]          10,240
     BatchNorm2d-282           [-1, 32, 35, 35]              64
            ReLU-283           [-1, 32, 35, 35]               0
     BasicConv2d-284           [-1, 32, 35, 35]               0
          Conv2d-285           [-1, 48, 35, 35]          13,824
     BatchNorm2d-286           [-1, 48, 35, 35]              96
            ReLU-287           [-1, 48, 35, 35]               0
     BasicConv2d-288           [-1, 48, 35, 35]               0
          Conv2d-289           [-1, 64, 35, 35]          27,648
     BatchNorm2d-290           [-1, 64, 35, 35]             128
            ReLU-291           [-1, 64, 35, 35]               0
     BasicConv2d-292           [-1, 64, 35, 35]               0
          Conv2d-293          [-1, 320, 35, 35]          41,280
            ReLU-294          [-1, 320, 35, 35]               0
         Block35-295          [-1, 320, 35, 35]               0
          Conv2d-296           [-1, 32, 35, 35]          10,240
     BatchNorm2d-297           [-1, 32, 35, 35]              64
            ReLU-298           [-1, 32, 35, 35]               0
     BasicConv2d-299           [-1, 32, 35, 35]               0
          Conv2d-300           [-1, 32, 35, 35]          10,240
     BatchNorm2d-301           [-1, 32, 35, 35]              64
            ReLU-302           [-1, 32, 35, 35]               0
     BasicConv2d-303           [-1, 32, 35, 35]               0
          Conv2d-304           [-1, 32, 35, 35]           9,216
     BatchNorm2d-305           [-1, 32, 35, 35]              64
            ReLU-306           [-1, 32, 35, 35]               0
     BasicConv2d-307           [-1, 32, 35, 35]               0
          Conv2d-308           [-1, 32, 35, 35]          10,240
     BatchNorm2d-309           [-1, 32, 35, 35]              64
            ReLU-310           [-1, 32, 35, 35]               0
     BasicConv2d-311           [-1, 32, 35, 35]               0
          Conv2d-312           [-1, 48, 35, 35]          13,824
     BatchNorm2d-313           [-1, 48, 35, 35]              96
            ReLU-314           [-1, 48, 35, 35]               0
     BasicConv2d-315           [-1, 48, 35, 35]               0
          Conv2d-316           [-1, 64, 35, 35]          27,648
     BatchNorm2d-317           [-1, 64, 35, 35]             128
            ReLU-318           [-1, 64, 35, 35]               0
     BasicConv2d-319           [-1, 64, 35, 35]               0
          Conv2d-320          [-1, 320, 35, 35]          41,280
            ReLU-321          [-1, 320, 35, 35]               0
         Block35-322          [-1, 320, 35, 35]               0
          Conv2d-323          [-1, 384, 17, 17]       1,105,920
     BatchNorm2d-324          [-1, 384, 17, 17]             768
            ReLU-325          [-1, 384, 17, 17]               0
     BasicConv2d-326          [-1, 384, 17, 17]               0
          Conv2d-327          [-1, 256, 35, 35]          81,920
     BatchNorm2d-328          [-1, 256, 35, 35]             512
            ReLU-329          [-1, 256, 35, 35]               0
     BasicConv2d-330          [-1, 256, 35, 35]               0
          Conv2d-331          [-1, 256, 35, 35]         589,824
     BatchNorm2d-332          [-1, 256, 35, 35]             512
            ReLU-333          [-1, 256, 35, 35]               0
     BasicConv2d-334          [-1, 256, 35, 35]               0
          Conv2d-335          [-1, 384, 17, 17]         884,736
     BatchNorm2d-336          [-1, 384, 17, 17]             768
            ReLU-337          [-1, 384, 17, 17]               0
     BasicConv2d-338          [-1, 384, 17, 17]               0
       MaxPool2d-339          [-1, 320, 17, 17]               0
        Mixed_6a-340         [-1, 1088, 17, 17]               0
          Conv2d-341          [-1, 192, 17, 17]         208,896
     BatchNorm2d-342          [-1, 192, 17, 17]             384
            ReLU-343          [-1, 192, 17, 17]               0
     BasicConv2d-344          [-1, 192, 17, 17]               0
          Conv2d-345          [-1, 128, 17, 17]         139,264
     BatchNorm2d-346          [-1, 128, 17, 17]             256
            ReLU-347          [-1, 128, 17, 17]               0
     BasicConv2d-348          [-1, 128, 17, 17]               0
          Conv2d-349          [-1, 160, 17, 17]         143,360
     BatchNorm2d-350          [-1, 160, 17, 17]             320
            ReLU-351          [-1, 160, 17, 17]               0
     BasicConv2d-352          [-1, 160, 17, 17]               0
          Conv2d-353          [-1, 192, 17, 17]         215,040
     BatchNorm2d-354          [-1, 192, 17, 17]             384
            ReLU-355          [-1, 192, 17, 17]               0
     BasicConv2d-356          [-1, 192, 17, 17]               0
          Conv2d-357         [-1, 1088, 17, 17]         418,880
            ReLU-358         [-1, 1088, 17, 17]               0
         Block17-359         [-1, 1088, 17, 17]               0
          Conv2d-360          [-1, 192, 17, 17]         208,896
     BatchNorm2d-361          [-1, 192, 17, 17]             384
            ReLU-362          [-1, 192, 17, 17]               0
     BasicConv2d-363          [-1, 192, 17, 17]               0
          Conv2d-364          [-1, 128, 17, 17]         139,264
     BatchNorm2d-365          [-1, 128, 17, 17]             256
            ReLU-366          [-1, 128, 17, 17]               0
     BasicConv2d-367          [-1, 128, 17, 17]               0
          Conv2d-368          [-1, 160, 17, 17]         143,360
     BatchNorm2d-369          [-1, 160, 17, 17]             320
            ReLU-370          [-1, 160, 17, 17]               0
     BasicConv2d-371          [-1, 160, 17, 17]               0
          Conv2d-372          [-1, 192, 17, 17]         215,040
     BatchNorm2d-373          [-1, 192, 17, 17]             384
            ReLU-374          [-1, 192, 17, 17]               0
     BasicConv2d-375          [-1, 192, 17, 17]               0
          Conv2d-376         [-1, 1088, 17, 17]         418,880
            ReLU-377         [-1, 1088, 17, 17]               0
         Block17-378         [-1, 1088, 17, 17]               0
          Conv2d-379          [-1, 192, 17, 17]         208,896
     BatchNorm2d-380          [-1, 192, 17, 17]             384
            ReLU-381          [-1, 192, 17, 17]               0
     BasicConv2d-382          [-1, 192, 17, 17]               0
          Conv2d-383          [-1, 128, 17, 17]         139,264
     BatchNorm2d-384          [-1, 128, 17, 17]             256
            ReLU-385          [-1, 128, 17, 17]               0
     BasicConv2d-386          [-1, 128, 17, 17]               0
          Conv2d-387          [-1, 160, 17, 17]         143,360
     BatchNorm2d-388          [-1, 160, 17, 17]             320
            ReLU-389          [-1, 160, 17, 17]               0
     BasicConv2d-390          [-1, 160, 17, 17]               0
          Conv2d-391          [-1, 192, 17, 17]         215,040
     BatchNorm2d-392          [-1, 192, 17, 17]             384
            ReLU-393          [-1, 192, 17, 17]               0
     BasicConv2d-394          [-1, 192, 17, 17]               0
          Conv2d-395         [-1, 1088, 17, 17]         418,880
            ReLU-396         [-1, 1088, 17, 17]               0
         Block17-397         [-1, 1088, 17, 17]               0
          Conv2d-398          [-1, 192, 17, 17]         208,896
     BatchNorm2d-399          [-1, 192, 17, 17]             384
            ReLU-400          [-1, 192, 17, 17]               0
     BasicConv2d-401          [-1, 192, 17, 17]               0
          Conv2d-402          [-1, 128, 17, 17]         139,264
     BatchNorm2d-403          [-1, 128, 17, 17]             256
            ReLU-404          [-1, 128, 17, 17]               0
     BasicConv2d-405          [-1, 128, 17, 17]               0
          Conv2d-406          [-1, 160, 17, 17]         143,360
     BatchNorm2d-407          [-1, 160, 17, 17]             320
            ReLU-408          [-1, 160, 17, 17]               0
     BasicConv2d-409          [-1, 160, 17, 17]               0
          Conv2d-410          [-1, 192, 17, 17]         215,040
     BatchNorm2d-411          [-1, 192, 17, 17]             384
            ReLU-412          [-1, 192, 17, 17]               0
     BasicConv2d-413          [-1, 192, 17, 17]               0
          Conv2d-414         [-1, 1088, 17, 17]         418,880
            ReLU-415         [-1, 1088, 17, 17]               0
         Block17-416         [-1, 1088, 17, 17]               0
          Conv2d-417          [-1, 192, 17, 17]         208,896
     BatchNorm2d-418          [-1, 192, 17, 17]             384
            ReLU-419          [-1, 192, 17, 17]               0
     BasicConv2d-420          [-1, 192, 17, 17]               0
          Conv2d-421          [-1, 128, 17, 17]         139,264
     BatchNorm2d-422          [-1, 128, 17, 17]             256
            ReLU-423          [-1, 128, 17, 17]               0
     BasicConv2d-424          [-1, 128, 17, 17]               0
          Conv2d-425          [-1, 160, 17, 17]         143,360
     BatchNorm2d-426          [-1, 160, 17, 17]             320
            ReLU-427          [-1, 160, 17, 17]               0
     BasicConv2d-428          [-1, 160, 17, 17]               0
          Conv2d-429          [-1, 192, 17, 17]         215,040
     BatchNorm2d-430          [-1, 192, 17, 17]             384
            ReLU-431          [-1, 192, 17, 17]               0
     BasicConv2d-432          [-1, 192, 17, 17]               0
          Conv2d-433         [-1, 1088, 17, 17]         418,880
            ReLU-434         [-1, 1088, 17, 17]               0
         Block17-435         [-1, 1088, 17, 17]               0
          Conv2d-436          [-1, 192, 17, 17]         208,896
     BatchNorm2d-437          [-1, 192, 17, 17]             384
            ReLU-438          [-1, 192, 17, 17]               0
     BasicConv2d-439          [-1, 192, 17, 17]               0
          Conv2d-440          [-1, 128, 17, 17]         139,264
     BatchNorm2d-441          [-1, 128, 17, 17]             256
            ReLU-442          [-1, 128, 17, 17]               0
     BasicConv2d-443          [-1, 128, 17, 17]               0
          Conv2d-444          [-1, 160, 17, 17]         143,360
     BatchNorm2d-445          [-1, 160, 17, 17]             320
            ReLU-446          [-1, 160, 17, 17]               0
     BasicConv2d-447          [-1, 160, 17, 17]               0
          Conv2d-448          [-1, 192, 17, 17]         215,040
     BatchNorm2d-449          [-1, 192, 17, 17]             384
            ReLU-450          [-1, 192, 17, 17]               0
     BasicConv2d-451          [-1, 192, 17, 17]               0
          Conv2d-452         [-1, 1088, 17, 17]         418,880
            ReLU-453         [-1, 1088, 17, 17]               0
         Block17-454         [-1, 1088, 17, 17]               0
          Conv2d-455          [-1, 192, 17, 17]         208,896
     BatchNorm2d-456          [-1, 192, 17, 17]             384
            ReLU-457          [-1, 192, 17, 17]               0
     BasicConv2d-458          [-1, 192, 17, 17]               0
          Conv2d-459          [-1, 128, 17, 17]         139,264
     BatchNorm2d-460          [-1, 128, 17, 17]             256
            ReLU-461          [-1, 128, 17, 17]               0
     BasicConv2d-462          [-1, 128, 17, 17]               0
          Conv2d-463          [-1, 160, 17, 17]         143,360
     BatchNorm2d-464          [-1, 160, 17, 17]             320
            ReLU-465          [-1, 160, 17, 17]               0
     BasicConv2d-466          [-1, 160, 17, 17]               0
          Conv2d-467          [-1, 192, 17, 17]         215,040
     BatchNorm2d-468          [-1, 192, 17, 17]             384
            ReLU-469          [-1, 192, 17, 17]               0
     BasicConv2d-470          [-1, 192, 17, 17]               0
          Conv2d-471         [-1, 1088, 17, 17]         418,880
            ReLU-472         [-1, 1088, 17, 17]               0
         Block17-473         [-1, 1088, 17, 17]               0
          Conv2d-474          [-1, 192, 17, 17]         208,896
     BatchNorm2d-475          [-1, 192, 17, 17]             384
            ReLU-476          [-1, 192, 17, 17]               0
     BasicConv2d-477          [-1, 192, 17, 17]               0
          Conv2d-478          [-1, 128, 17, 17]         139,264
     BatchNorm2d-479          [-1, 128, 17, 17]             256
            ReLU-480          [-1, 128, 17, 17]               0
     BasicConv2d-481          [-1, 128, 17, 17]               0
          Conv2d-482          [-1, 160, 17, 17]         143,360
     BatchNorm2d-483          [-1, 160, 17, 17]             320
            ReLU-484          [-1, 160, 17, 17]               0
     BasicConv2d-485          [-1, 160, 17, 17]               0
          Conv2d-486          [-1, 192, 17, 17]         215,040
     BatchNorm2d-487          [-1, 192, 17, 17]             384
            ReLU-488          [-1, 192, 17, 17]               0
     BasicConv2d-489          [-1, 192, 17, 17]               0
          Conv2d-490         [-1, 1088, 17, 17]         418,880
            ReLU-491         [-1, 1088, 17, 17]               0
         Block17-492         [-1, 1088, 17, 17]               0
          Conv2d-493          [-1, 192, 17, 17]         208,896
     BatchNorm2d-494          [-1, 192, 17, 17]             384
            ReLU-495          [-1, 192, 17, 17]               0
     BasicConv2d-496          [-1, 192, 17, 17]               0
          Conv2d-497          [-1, 128, 17, 17]         139,264
     BatchNorm2d-498          [-1, 128, 17, 17]             256
            ReLU-499          [-1, 128, 17, 17]               0
     BasicConv2d-500          [-1, 128, 17, 17]               0
          Conv2d-501          [-1, 160, 17, 17]         143,360
     BatchNorm2d-502          [-1, 160, 17, 17]             320
            ReLU-503          [-1, 160, 17, 17]               0
     BasicConv2d-504          [-1, 160, 17, 17]               0
          Conv2d-505          [-1, 192, 17, 17]         215,040
     BatchNorm2d-506          [-1, 192, 17, 17]             384
            ReLU-507          [-1, 192, 17, 17]               0
     BasicConv2d-508          [-1, 192, 17, 17]               0
          Conv2d-509         [-1, 1088, 17, 17]         418,880
            ReLU-510         [-1, 1088, 17, 17]               0
         Block17-511         [-1, 1088, 17, 17]               0
          Conv2d-512          [-1, 192, 17, 17]         208,896
     BatchNorm2d-513          [-1, 192, 17, 17]             384
            ReLU-514          [-1, 192, 17, 17]               0
     BasicConv2d-515          [-1, 192, 17, 17]               0
          Conv2d-516          [-1, 128, 17, 17]         139,264
     BatchNorm2d-517          [-1, 128, 17, 17]             256
            ReLU-518          [-1, 128, 17, 17]               0
     BasicConv2d-519          [-1, 128, 17, 17]               0
          Conv2d-520          [-1, 160, 17, 17]         143,360
     BatchNorm2d-521          [-1, 160, 17, 17]             320
            ReLU-522          [-1, 160, 17, 17]               0
     BasicConv2d-523          [-1, 160, 17, 17]               0
          Conv2d-524          [-1, 192, 17, 17]         215,040
     BatchNorm2d-525          [-1, 192, 17, 17]             384
            ReLU-526          [-1, 192, 17, 17]               0
     BasicConv2d-527          [-1, 192, 17, 17]               0
          Conv2d-528         [-1, 1088, 17, 17]         418,880
            ReLU-529         [-1, 1088, 17, 17]               0
         Block17-530         [-1, 1088, 17, 17]               0
          Conv2d-531          [-1, 192, 17, 17]         208,896
     BatchNorm2d-532          [-1, 192, 17, 17]             384
            ReLU-533          [-1, 192, 17, 17]               0
     BasicConv2d-534          [-1, 192, 17, 17]               0
          Conv2d-535          [-1, 128, 17, 17]         139,264
     BatchNorm2d-536          [-1, 128, 17, 17]             256
            ReLU-537          [-1, 128, 17, 17]               0
     BasicConv2d-538          [-1, 128, 17, 17]               0
          Conv2d-539          [-1, 160, 17, 17]         143,360
     BatchNorm2d-540          [-1, 160, 17, 17]             320
            ReLU-541          [-1, 160, 17, 17]               0
     BasicConv2d-542          [-1, 160, 17, 17]               0
          Conv2d-543          [-1, 192, 17, 17]         215,040
     BatchNorm2d-544          [-1, 192, 17, 17]             384
            ReLU-545          [-1, 192, 17, 17]               0
     BasicConv2d-546          [-1, 192, 17, 17]               0
          Conv2d-547         [-1, 1088, 17, 17]         418,880
            ReLU-548         [-1, 1088, 17, 17]               0
         Block17-549         [-1, 1088, 17, 17]               0
          Conv2d-550          [-1, 192, 17, 17]         208,896
     BatchNorm2d-551          [-1, 192, 17, 17]             384
            ReLU-552          [-1, 192, 17, 17]               0
     BasicConv2d-553          [-1, 192, 17, 17]               0
          Conv2d-554          [-1, 128, 17, 17]         139,264
     BatchNorm2d-555          [-1, 128, 17, 17]             256
            ReLU-556          [-1, 128, 17, 17]               0
     BasicConv2d-557          [-1, 128, 17, 17]               0
          Conv2d-558          [-1, 160, 17, 17]         143,360
     BatchNorm2d-559          [-1, 160, 17, 17]             320
            ReLU-560          [-1, 160, 17, 17]               0
     BasicConv2d-561          [-1, 160, 17, 17]               0
          Conv2d-562          [-1, 192, 17, 17]         215,040
     BatchNorm2d-563          [-1, 192, 17, 17]             384
            ReLU-564          [-1, 192, 17, 17]               0
     BasicConv2d-565          [-1, 192, 17, 17]               0
          Conv2d-566         [-1, 1088, 17, 17]         418,880
            ReLU-567         [-1, 1088, 17, 17]               0
         Block17-568         [-1, 1088, 17, 17]               0
          Conv2d-569          [-1, 192, 17, 17]         208,896
     BatchNorm2d-570          [-1, 192, 17, 17]             384
            ReLU-571          [-1, 192, 17, 17]               0
     BasicConv2d-572          [-1, 192, 17, 17]               0
          Conv2d-573          [-1, 128, 17, 17]         139,264
     BatchNorm2d-574          [-1, 128, 17, 17]             256
            ReLU-575          [-1, 128, 17, 17]               0
     BasicConv2d-576          [-1, 128, 17, 17]               0
          Conv2d-577          [-1, 160, 17, 17]         143,360
     BatchNorm2d-578          [-1, 160, 17, 17]             320
            ReLU-579          [-1, 160, 17, 17]               0
     BasicConv2d-580          [-1, 160, 17, 17]               0
          Conv2d-581          [-1, 192, 17, 17]         215,040
     BatchNorm2d-582          [-1, 192, 17, 17]             384
            ReLU-583          [-1, 192, 17, 17]               0
     BasicConv2d-584          [-1, 192, 17, 17]               0
          Conv2d-585         [-1, 1088, 17, 17]         418,880
            ReLU-586         [-1, 1088, 17, 17]               0
         Block17-587         [-1, 1088, 17, 17]               0
          Conv2d-588          [-1, 192, 17, 17]         208,896
     BatchNorm2d-589          [-1, 192, 17, 17]             384
            ReLU-590          [-1, 192, 17, 17]               0
     BasicConv2d-591          [-1, 192, 17, 17]               0
          Conv2d-592          [-1, 128, 17, 17]         139,264
     BatchNorm2d-593          [-1, 128, 17, 17]             256
            ReLU-594          [-1, 128, 17, 17]               0
     BasicConv2d-595          [-1, 128, 17, 17]               0
          Conv2d-596          [-1, 160, 17, 17]         143,360
     BatchNorm2d-597          [-1, 160, 17, 17]             320
            ReLU-598          [-1, 160, 17, 17]               0
     BasicConv2d-599          [-1, 160, 17, 17]               0
          Conv2d-600          [-1, 192, 17, 17]         215,040
     BatchNorm2d-601          [-1, 192, 17, 17]             384
            ReLU-602          [-1, 192, 17, 17]               0
     BasicConv2d-603          [-1, 192, 17, 17]               0
          Conv2d-604         [-1, 1088, 17, 17]         418,880
            ReLU-605         [-1, 1088, 17, 17]               0
         Block17-606         [-1, 1088, 17, 17]               0
          Conv2d-607          [-1, 192, 17, 17]         208,896
     BatchNorm2d-608          [-1, 192, 17, 17]             384
            ReLU-609          [-1, 192, 17, 17]               0
     BasicConv2d-610          [-1, 192, 17, 17]               0
          Conv2d-611          [-1, 128, 17, 17]         139,264
     BatchNorm2d-612          [-1, 128, 17, 17]             256
            ReLU-613          [-1, 128, 17, 17]               0
     BasicConv2d-614          [-1, 128, 17, 17]               0
          Conv2d-615          [-1, 160, 17, 17]         143,360
     BatchNorm2d-616          [-1, 160, 17, 17]             320
            ReLU-617          [-1, 160, 17, 17]               0
     BasicConv2d-618          [-1, 160, 17, 17]               0
          Conv2d-619          [-1, 192, 17, 17]         215,040
     BatchNorm2d-620          [-1, 192, 17, 17]             384
            ReLU-621          [-1, 192, 17, 17]               0
     BasicConv2d-622          [-1, 192, 17, 17]               0
          Conv2d-623         [-1, 1088, 17, 17]         418,880
            ReLU-624         [-1, 1088, 17, 17]               0
         Block17-625         [-1, 1088, 17, 17]               0
          Conv2d-626          [-1, 192, 17, 17]         208,896
     BatchNorm2d-627          [-1, 192, 17, 17]             384
            ReLU-628          [-1, 192, 17, 17]               0
     BasicConv2d-629          [-1, 192, 17, 17]               0
          Conv2d-630          [-1, 128, 17, 17]         139,264
     BatchNorm2d-631          [-1, 128, 17, 17]             256
            ReLU-632          [-1, 128, 17, 17]               0
     BasicConv2d-633          [-1, 128, 17, 17]               0
          Conv2d-634          [-1, 160, 17, 17]         143,360
     BatchNorm2d-635          [-1, 160, 17, 17]             320
            ReLU-636          [-1, 160, 17, 17]               0
     BasicConv2d-637          [-1, 160, 17, 17]               0
          Conv2d-638          [-1, 192, 17, 17]         215,040
     BatchNorm2d-639          [-1, 192, 17, 17]             384
            ReLU-640          [-1, 192, 17, 17]               0
     BasicConv2d-641          [-1, 192, 17, 17]               0
          Conv2d-642         [-1, 1088, 17, 17]         418,880
            ReLU-643         [-1, 1088, 17, 17]               0
         Block17-644         [-1, 1088, 17, 17]               0
          Conv2d-645          [-1, 192, 17, 17]         208,896
     BatchNorm2d-646          [-1, 192, 17, 17]             384
            ReLU-647          [-1, 192, 17, 17]               0
     BasicConv2d-648          [-1, 192, 17, 17]               0
          Conv2d-649          [-1, 128, 17, 17]         139,264
     BatchNorm2d-650          [-1, 128, 17, 17]             256
            ReLU-651          [-1, 128, 17, 17]               0
     BasicConv2d-652          [-1, 128, 17, 17]               0
          Conv2d-653          [-1, 160, 17, 17]         143,360
     BatchNorm2d-654          [-1, 160, 17, 17]             320
            ReLU-655          [-1, 160, 17, 17]               0
     BasicConv2d-656          [-1, 160, 17, 17]               0
          Conv2d-657          [-1, 192, 17, 17]         215,040
     BatchNorm2d-658          [-1, 192, 17, 17]             384
            ReLU-659          [-1, 192, 17, 17]               0
     BasicConv2d-660          [-1, 192, 17, 17]               0
          Conv2d-661         [-1, 1088, 17, 17]         418,880
            ReLU-662         [-1, 1088, 17, 17]               0
         Block17-663         [-1, 1088, 17, 17]               0
          Conv2d-664          [-1, 192, 17, 17]         208,896
     BatchNorm2d-665          [-1, 192, 17, 17]             384
            ReLU-666          [-1, 192, 17, 17]               0
     BasicConv2d-667          [-1, 192, 17, 17]               0
          Conv2d-668          [-1, 128, 17, 17]         139,264
     BatchNorm2d-669          [-1, 128, 17, 17]             256
            ReLU-670          [-1, 128, 17, 17]               0
     BasicConv2d-671          [-1, 128, 17, 17]               0
          Conv2d-672          [-1, 160, 17, 17]         143,360
     BatchNorm2d-673          [-1, 160, 17, 17]             320
            ReLU-674          [-1, 160, 17, 17]               0
     BasicConv2d-675          [-1, 160, 17, 17]               0
          Conv2d-676          [-1, 192, 17, 17]         215,040
     BatchNorm2d-677          [-1, 192, 17, 17]             384
            ReLU-678          [-1, 192, 17, 17]               0
     BasicConv2d-679          [-1, 192, 17, 17]               0
          Conv2d-680         [-1, 1088, 17, 17]         418,880
            ReLU-681         [-1, 1088, 17, 17]               0
         Block17-682         [-1, 1088, 17, 17]               0
          Conv2d-683          [-1, 192, 17, 17]         208,896
     BatchNorm2d-684          [-1, 192, 17, 17]             384
            ReLU-685          [-1, 192, 17, 17]               0
     BasicConv2d-686          [-1, 192, 17, 17]               0
          Conv2d-687          [-1, 128, 17, 17]         139,264
     BatchNorm2d-688          [-1, 128, 17, 17]             256
            ReLU-689          [-1, 128, 17, 17]               0
     BasicConv2d-690          [-1, 128, 17, 17]               0
          Conv2d-691          [-1, 160, 17, 17]         143,360
     BatchNorm2d-692          [-1, 160, 17, 17]             320
            ReLU-693          [-1, 160, 17, 17]               0
     BasicConv2d-694          [-1, 160, 17, 17]               0
          Conv2d-695          [-1, 192, 17, 17]         215,040
     BatchNorm2d-696          [-1, 192, 17, 17]             384
            ReLU-697          [-1, 192, 17, 17]               0
     BasicConv2d-698          [-1, 192, 17, 17]               0
          Conv2d-699         [-1, 1088, 17, 17]         418,880
            ReLU-700         [-1, 1088, 17, 17]               0
         Block17-701         [-1, 1088, 17, 17]               0
          Conv2d-702          [-1, 192, 17, 17]         208,896
     BatchNorm2d-703          [-1, 192, 17, 17]             384
            ReLU-704          [-1, 192, 17, 17]               0
     BasicConv2d-705          [-1, 192, 17, 17]               0
          Conv2d-706          [-1, 128, 17, 17]         139,264
     BatchNorm2d-707          [-1, 128, 17, 17]             256
            ReLU-708          [-1, 128, 17, 17]               0
     BasicConv2d-709          [-1, 128, 17, 17]               0
          Conv2d-710          [-1, 160, 17, 17]         143,360
     BatchNorm2d-711          [-1, 160, 17, 17]             320
            ReLU-712          [-1, 160, 17, 17]               0
     BasicConv2d-713          [-1, 160, 17, 17]               0
          Conv2d-714          [-1, 192, 17, 17]         215,040
     BatchNorm2d-715          [-1, 192, 17, 17]             384
            ReLU-716          [-1, 192, 17, 17]               0
     BasicConv2d-717          [-1, 192, 17, 17]               0
          Conv2d-718         [-1, 1088, 17, 17]         418,880
            ReLU-719         [-1, 1088, 17, 17]               0
         Block17-720         [-1, 1088, 17, 17]               0
          Conv2d-721          [-1, 256, 17, 17]         278,528
     BatchNorm2d-722          [-1, 256, 17, 17]             512
            ReLU-723          [-1, 256, 17, 17]               0
     BasicConv2d-724          [-1, 256, 17, 17]               0
          Conv2d-725            [-1, 384, 8, 8]         884,736
     BatchNorm2d-726            [-1, 384, 8, 8]             768
            ReLU-727            [-1, 384, 8, 8]               0
     BasicConv2d-728            [-1, 384, 8, 8]               0
          Conv2d-729          [-1, 256, 17, 17]         278,528
     BatchNorm2d-730          [-1, 256, 17, 17]             512
            ReLU-731          [-1, 256, 17, 17]               0
     BasicConv2d-732          [-1, 256, 17, 17]               0
          Conv2d-733            [-1, 288, 8, 8]         663,552
     BatchNorm2d-734            [-1, 288, 8, 8]             576
            ReLU-735            [-1, 288, 8, 8]               0
     BasicConv2d-736            [-1, 288, 8, 8]               0
          Conv2d-737          [-1, 256, 17, 17]         278,528
     BatchNorm2d-738          [-1, 256, 17, 17]             512
            ReLU-739          [-1, 256, 17, 17]               0
     BasicConv2d-740          [-1, 256, 17, 17]               0
          Conv2d-741          [-1, 288, 17, 17]         663,552
     BatchNorm2d-742          [-1, 288, 17, 17]             576
            ReLU-743          [-1, 288, 17, 17]               0
     BasicConv2d-744          [-1, 288, 17, 17]               0
          Conv2d-745            [-1, 320, 8, 8]         829,440
     BatchNorm2d-746            [-1, 320, 8, 8]             640
            ReLU-747            [-1, 320, 8, 8]               0
     BasicConv2d-748            [-1, 320, 8, 8]               0
       MaxPool2d-749           [-1, 1088, 8, 8]               0
        Mixed_7a-750           [-1, 2080, 8, 8]               0
          Conv2d-751            [-1, 192, 8, 8]         399,360
     BatchNorm2d-752            [-1, 192, 8, 8]             384
            ReLU-753            [-1, 192, 8, 8]               0
     BasicConv2d-754            [-1, 192, 8, 8]               0
          Conv2d-755            [-1, 192, 8, 8]         399,360
     BatchNorm2d-756            [-1, 192, 8, 8]             384
            ReLU-757            [-1, 192, 8, 8]               0
     BasicConv2d-758            [-1, 192, 8, 8]               0
          Conv2d-759            [-1, 224, 8, 8]         129,024
     BatchNorm2d-760            [-1, 224, 8, 8]             448
            ReLU-761            [-1, 224, 8, 8]               0
     BasicConv2d-762            [-1, 224, 8, 8]               0
          Conv2d-763            [-1, 256, 8, 8]         172,032
     BatchNorm2d-764            [-1, 256, 8, 8]             512
            ReLU-765            [-1, 256, 8, 8]               0
     BasicConv2d-766            [-1, 256, 8, 8]               0
          Conv2d-767           [-1, 2080, 8, 8]         933,920
            ReLU-768           [-1, 2080, 8, 8]               0
          Block8-769           [-1, 2080, 8, 8]               0
          Conv2d-770            [-1, 192, 8, 8]         399,360
     BatchNorm2d-771            [-1, 192, 8, 8]             384
            ReLU-772            [-1, 192, 8, 8]               0
     BasicConv2d-773            [-1, 192, 8, 8]               0
          Conv2d-774            [-1, 192, 8, 8]         399,360
     BatchNorm2d-775            [-1, 192, 8, 8]             384
            ReLU-776            [-1, 192, 8, 8]               0
     BasicConv2d-777            [-1, 192, 8, 8]               0
          Conv2d-778            [-1, 224, 8, 8]         129,024
     BatchNorm2d-779            [-1, 224, 8, 8]             448
            ReLU-780            [-1, 224, 8, 8]               0
     BasicConv2d-781            [-1, 224, 8, 8]               0
          Conv2d-782            [-1, 256, 8, 8]         172,032
     BatchNorm2d-783            [-1, 256, 8, 8]             512
            ReLU-784            [-1, 256, 8, 8]               0
     BasicConv2d-785            [-1, 256, 8, 8]               0
          Conv2d-786           [-1, 2080, 8, 8]         933,920
            ReLU-787           [-1, 2080, 8, 8]               0
          Block8-788           [-1, 2080, 8, 8]               0
          Conv2d-789            [-1, 192, 8, 8]         399,360
     BatchNorm2d-790            [-1, 192, 8, 8]             384
            ReLU-791            [-1, 192, 8, 8]               0
     BasicConv2d-792            [-1, 192, 8, 8]               0
          Conv2d-793            [-1, 192, 8, 8]         399,360
     BatchNorm2d-794            [-1, 192, 8, 8]             384
            ReLU-795            [-1, 192, 8, 8]               0
     BasicConv2d-796            [-1, 192, 8, 8]               0
          Conv2d-797            [-1, 224, 8, 8]         129,024
     BatchNorm2d-798            [-1, 224, 8, 8]             448
            ReLU-799            [-1, 224, 8, 8]               0
     BasicConv2d-800            [-1, 224, 8, 8]               0
          Conv2d-801            [-1, 256, 8, 8]         172,032
     BatchNorm2d-802            [-1, 256, 8, 8]             512
            ReLU-803            [-1, 256, 8, 8]               0
     BasicConv2d-804            [-1, 256, 8, 8]               0
          Conv2d-805           [-1, 2080, 8, 8]         933,920
            ReLU-806           [-1, 2080, 8, 8]               0
          Block8-807           [-1, 2080, 8, 8]               0
          Conv2d-808            [-1, 192, 8, 8]         399,360
     BatchNorm2d-809            [-1, 192, 8, 8]             384
            ReLU-810            [-1, 192, 8, 8]               0
     BasicConv2d-811            [-1, 192, 8, 8]               0
          Conv2d-812            [-1, 192, 8, 8]         399,360
     BatchNorm2d-813            [-1, 192, 8, 8]             384
            ReLU-814            [-1, 192, 8, 8]               0
     BasicConv2d-815            [-1, 192, 8, 8]               0
          Conv2d-816            [-1, 224, 8, 8]         129,024
     BatchNorm2d-817            [-1, 224, 8, 8]             448
            ReLU-818            [-1, 224, 8, 8]               0
     BasicConv2d-819            [-1, 224, 8, 8]               0
          Conv2d-820            [-1, 256, 8, 8]         172,032
     BatchNorm2d-821            [-1, 256, 8, 8]             512
            ReLU-822            [-1, 256, 8, 8]               0
     BasicConv2d-823            [-1, 256, 8, 8]               0
          Conv2d-824           [-1, 2080, 8, 8]         933,920
            ReLU-825           [-1, 2080, 8, 8]               0
          Block8-826           [-1, 2080, 8, 8]               0
          Conv2d-827            [-1, 192, 8, 8]         399,360
     BatchNorm2d-828            [-1, 192, 8, 8]             384
            ReLU-829            [-1, 192, 8, 8]               0
     BasicConv2d-830            [-1, 192, 8, 8]               0
          Conv2d-831            [-1, 192, 8, 8]         399,360
     BatchNorm2d-832            [-1, 192, 8, 8]             384
            ReLU-833            [-1, 192, 8, 8]               0
     BasicConv2d-834            [-1, 192, 8, 8]               0
          Conv2d-835            [-1, 224, 8, 8]         129,024
     BatchNorm2d-836            [-1, 224, 8, 8]             448
            ReLU-837            [-1, 224, 8, 8]               0
     BasicConv2d-838            [-1, 224, 8, 8]               0
          Conv2d-839            [-1, 256, 8, 8]         172,032
     BatchNorm2d-840            [-1, 256, 8, 8]             512
            ReLU-841            [-1, 256, 8, 8]               0
     BasicConv2d-842            [-1, 256, 8, 8]               0
          Conv2d-843           [-1, 2080, 8, 8]         933,920
            ReLU-844           [-1, 2080, 8, 8]               0
          Block8-845           [-1, 2080, 8, 8]               0
          Conv2d-846            [-1, 192, 8, 8]         399,360
     BatchNorm2d-847            [-1, 192, 8, 8]             384
            ReLU-848            [-1, 192, 8, 8]               0
     BasicConv2d-849            [-1, 192, 8, 8]               0
          Conv2d-850            [-1, 192, 8, 8]         399,360
     BatchNorm2d-851            [-1, 192, 8, 8]             384
            ReLU-852            [-1, 192, 8, 8]               0
     BasicConv2d-853            [-1, 192, 8, 8]               0
          Conv2d-854            [-1, 224, 8, 8]         129,024
     BatchNorm2d-855            [-1, 224, 8, 8]             448
            ReLU-856            [-1, 224, 8, 8]               0
     BasicConv2d-857            [-1, 224, 8, 8]               0
          Conv2d-858            [-1, 256, 8, 8]         172,032
     BatchNorm2d-859            [-1, 256, 8, 8]             512
            ReLU-860            [-1, 256, 8, 8]               0
     BasicConv2d-861            [-1, 256, 8, 8]               0
          Conv2d-862           [-1, 2080, 8, 8]         933,920
            ReLU-863           [-1, 2080, 8, 8]               0
          Block8-864           [-1, 2080, 8, 8]               0
          Conv2d-865            [-1, 192, 8, 8]         399,360
     BatchNorm2d-866            [-1, 192, 8, 8]             384
            ReLU-867            [-1, 192, 8, 8]               0
     BasicConv2d-868            [-1, 192, 8, 8]               0
          Conv2d-869            [-1, 192, 8, 8]         399,360
     BatchNorm2d-870            [-1, 192, 8, 8]             384
            ReLU-871            [-1, 192, 8, 8]               0
     BasicConv2d-872            [-1, 192, 8, 8]               0
          Conv2d-873            [-1, 224, 8, 8]         129,024
     BatchNorm2d-874            [-1, 224, 8, 8]             448
            ReLU-875            [-1, 224, 8, 8]               0
     BasicConv2d-876            [-1, 224, 8, 8]               0
          Conv2d-877            [-1, 256, 8, 8]         172,032
     BatchNorm2d-878            [-1, 256, 8, 8]             512
            ReLU-879            [-1, 256, 8, 8]               0
     BasicConv2d-880            [-1, 256, 8, 8]               0
          Conv2d-881           [-1, 2080, 8, 8]         933,920
            ReLU-882           [-1, 2080, 8, 8]               0
          Block8-883           [-1, 2080, 8, 8]               0
          Conv2d-884            [-1, 192, 8, 8]         399,360
     BatchNorm2d-885            [-1, 192, 8, 8]             384
            ReLU-886            [-1, 192, 8, 8]               0
     BasicConv2d-887            [-1, 192, 8, 8]               0
          Conv2d-888            [-1, 192, 8, 8]         399,360
     BatchNorm2d-889            [-1, 192, 8, 8]             384
            ReLU-890            [-1, 192, 8, 8]               0
     BasicConv2d-891            [-1, 192, 8, 8]               0
          Conv2d-892            [-1, 224, 8, 8]         129,024
     BatchNorm2d-893            [-1, 224, 8, 8]             448
            ReLU-894            [-1, 224, 8, 8]               0
     BasicConv2d-895            [-1, 224, 8, 8]               0
          Conv2d-896            [-1, 256, 8, 8]         172,032
     BatchNorm2d-897            [-1, 256, 8, 8]             512
            ReLU-898            [-1, 256, 8, 8]               0
     BasicConv2d-899            [-1, 256, 8, 8]               0
          Conv2d-900           [-1, 2080, 8, 8]         933,920
            ReLU-901           [-1, 2080, 8, 8]               0
          Block8-902           [-1, 2080, 8, 8]               0
          Conv2d-903            [-1, 192, 8, 8]         399,360
     BatchNorm2d-904            [-1, 192, 8, 8]             384
            ReLU-905            [-1, 192, 8, 8]               0
     BasicConv2d-906            [-1, 192, 8, 8]               0
          Conv2d-907            [-1, 192, 8, 8]         399,360
     BatchNorm2d-908            [-1, 192, 8, 8]             384
            ReLU-909            [-1, 192, 8, 8]               0
     BasicConv2d-910            [-1, 192, 8, 8]               0
          Conv2d-911            [-1, 224, 8, 8]         129,024
     BatchNorm2d-912            [-1, 224, 8, 8]             448
            ReLU-913            [-1, 224, 8, 8]               0
     BasicConv2d-914            [-1, 224, 8, 8]               0
          Conv2d-915            [-1, 256, 8, 8]         172,032
     BatchNorm2d-916            [-1, 256, 8, 8]             512
            ReLU-917            [-1, 256, 8, 8]               0
     BasicConv2d-918            [-1, 256, 8, 8]               0
          Conv2d-919           [-1, 2080, 8, 8]         933,920
            ReLU-920           [-1, 2080, 8, 8]               0
          Block8-921           [-1, 2080, 8, 8]               0
          Conv2d-922            [-1, 192, 8, 8]         399,360
     BatchNorm2d-923            [-1, 192, 8, 8]             384
            ReLU-924            [-1, 192, 8, 8]               0
     BasicConv2d-925            [-1, 192, 8, 8]               0
          Conv2d-926            [-1, 192, 8, 8]         399,360
     BatchNorm2d-927            [-1, 192, 8, 8]             384
            ReLU-928            [-1, 192, 8, 8]               0
     BasicConv2d-929            [-1, 192, 8, 8]               0
          Conv2d-930            [-1, 224, 8, 8]         129,024
     BatchNorm2d-931            [-1, 224, 8, 8]             448
            ReLU-932            [-1, 224, 8, 8]               0
     BasicConv2d-933            [-1, 224, 8, 8]               0
          Conv2d-934            [-1, 256, 8, 8]         172,032
     BatchNorm2d-935            [-1, 256, 8, 8]             512
            ReLU-936            [-1, 256, 8, 8]               0
     BasicConv2d-937            [-1, 256, 8, 8]               0
          Conv2d-938           [-1, 2080, 8, 8]         933,920
          Block8-939           [-1, 2080, 8, 8]               0
          Conv2d-940           [-1, 1536, 8, 8]       3,194,880
     BatchNorm2d-941           [-1, 1536, 8, 8]           3,072
            ReLU-942           [-1, 1536, 8, 8]               0
     BasicConv2d-943           [-1, 1536, 8, 8]               0
       AvgPool2d-944           [-1, 1536, 1, 1]               0
         Dropout-945                 [-1, 1536]               0
          Linear-946                 [-1, 1000]       1,537,000
            ReLU-947                 [-1, 1000]               0
          Linear-948                  [-1, 512]         512,512
            ReLU-949                  [-1, 512]               0
          Linear-950                  [-1, 448]         229,824
            ReLU-951                  [-1, 448]               0
          Linear-952                  [-1, 320]         143,680
            ReLU-953                  [-1, 320]               0
          Linear-954                    [-1, 2]             642
================================================================
Total params: 56,730,122
Trainable params: 2,423,658
Non-trainable params: 54,306,464
----------------------------------------------------------------
Input size (MB): 1.02
Forward/backward pass size (MB): 689.57
Params size (MB): 216.41
Estimated Total Size (MB): 907.00
----------------------------------------------------------------
```

#### Optimizer và loss

- Optimizer: sử dụng AdamW

```Python
criterion = nn.CrossEntropyLoss()
optimizer = torch.optim.AdamW(model_ft.last_linear.parameters(),
                            lr=learning_rate,
                            weight_decay=0.0005)
exp_lr_scheduler = lr_scheduler.MultiStepLR(optimizer, 
                                           milestones=[20,40,60,80, 100], 
                                           gamma=0.2)

```

#### Acc và loss

![](../../img/brain_tumor_4.png)

![](../../img/brain_tumor_5.png)

#### Miss classified data

![](../../img/brain_tumor_1.png)

### 2. Model sử dụng pretrained inceptionresnetv1 98% acc

Link: [Inceptionresnetv1 96%](../inception_resnet_v2_only_train_test_98.ipynb)

Path to model dict: [https://drive.google.com/file/d/1L1bfHlSaKmQRxv55BW0Vxpn4Pk9BYpCR/view?usp=sharing](https://drive.google.com/file/d/1L1bfHlSaKmQRxv55BW0Vxpn4Pk9BYpCR/view?usp=sharing)

#### Update so với bản 96%

Thay đổi `hyperparameters` với epochs là `50`

#### Acc và loss


![](../../img/brain_tumor_2.png)

![](../../img/brain_tumor_3.png)